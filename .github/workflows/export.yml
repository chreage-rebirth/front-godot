###############################################################################
## Stigmee: A 3D browser and decentralized social network.
## Copyright 2021 Quentin Quadrat <lecrapouille@gmail.com>
##
## This file is part of Stigmee.
##
## Stigmee is free software: you can redistribute it and/or modify it
## under the terms of the GNU General Public License as published by
## the Free Software Foundation, either version 3 of the License, or
## (at your option) any later version.
##
## This program is distributed in the hope that it will be useful, but
## WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
## General Public License for more details.
##
## You should have received a copy of the GNU General Public License
## along with this program.  If not, see <http://www.gnu.org/licenses/>.
###############################################################################
##
## This is a modification of https://github.com/dsaltares/godot-wild-jam-18
## Under the Apache-2.0 License. For more information see his blog at this link
## https://saltares.com/continuous-delivery-pipeline-for-godot-and-itch.io/
##
###############################################################################

on:
  workflow_dispatch: # push:
    branches:
      - master
    paths:
      - 'stigmee/**'

jobs:
  export_game:
    runs-on: ubuntu-latest
    name: Export stigmee
    env: # FIXME: The `add-path` command is disabled. Please upgrade to using Environment Files or opt into unsecur
       ACTIONS_ALLOW_UNSECURE_COMMANDS: 'true'
    steps:
    - name: checkout
      uses: actions/checkout@v2.0.0
    - name: export
      uses: firebelley/godot-export@v1.1.0
      with:
        base_version: 0.1.0
        godot_executable_download_url: https://downloads.tuxfamily.org/godotengine/3.2/Godot_v3.2-stable_linux_headless.64.zip
        godot_export_templates_download_url: https://downloads.tuxfamily.org/godotengine/3.2/Godot_v3.2-stable_export_templates.tpz
        godot_template_version: 3.2.stable
        relative_project_path: ./stigmee
      env:
        GITHUB_TOKEN: ${{ secrets.EXPORT_GITHUB_TOKEN }}
